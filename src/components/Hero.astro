---
import { getTranslations } from '../i18n/translations';
import { config } from '../config';

interface Props {
  lang?: 'en' | 'de';
}

const { lang = 'en' } = Astro.props;
const t = getTranslations(lang).hero;
const ts = getTranslations(lang).appShowcase;
const isAvailable = config.isProductAvailable;
---

<section class="relative min-h-screen flex flex-col pt-32 pb-20 overflow-hidden">
  <!-- Background decoration -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-0 left-1/2 -translate-x-1/2 w-[1000px] h-[1000px] bg-gradient-to-b from-[#d63c6b]/10 to-[#6b4c9a]/10 rounded-full blur-3xl animate-pulse-glow"></div>
  </div>
  
  <div class="container mx-auto px-6 relative z-10">
    <div class="flex flex-col items-center text-center max-w-4xl mx-auto mb-20">
      
      <!-- Logo -->
      <div class="mb-8">
        <img 
          src="/assets/ENDURE_lockup_exact_icon_4k_white_transparent.min.png" 
          alt="ENDURE Logo" 
          title="ENDURE - Indoor Cycling App"
          class="h-24 md:h-32 w-auto mx-auto"
        />
      </div>
      
      <!-- Badge -->
      <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-[#2f3340] border border-white/10 mb-8 backdrop-blur-sm">
        <span class="w-2 h-2 bg-[#F05D23] rounded-full animate-pulse"></span>
        <span class="text-sm text-[#a0a5b5]">{t.badge}</span>
      </div>
      
      <!-- Headline -->
      <h1 class="text-4xl md:text-6xl lg:text-7xl font-bold mb-8 leading-tight tracking-tight">
        <span class="block text-xl md:text-2xl font-medium text-[#F05D23] mb-2 tracking-wide uppercase">{t.tagline}</span>
        <span class="gradient-text">{t.headline1}</span>
        <span class="block mt-2 text-white">{t.headline2}</span>
      </h1>
      
      <!-- Subline -->
      <p class="text-xl md:text-2xl text-[#a0a5b5] mb-10 max-w-2xl mx-auto leading-relaxed" set:html={t.subline}></p>
      
      {isAvailable ? (
        <!-- CTA Button -->
        <div class="flex flex-col items-center gap-4 mb-2">
          <a id="download-btn" href="#download" class="btn-primary text-xl px-8 py-4 shadow-lg shadow-[#F05D23]/20 hover:shadow-[#F05D23]/40 transition-all">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-12.9-1.801"/>
            </svg>
            {t.cta}
          </a>
          
          <p class="text-sm text-[#6b7280] flex items-center gap-2">
            <span class="inline-block w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
            {t.secondary}
          </p>
        </div>
      ) : (
        <!-- Coming Soon -->
        <div class="flex flex-col items-center gap-4">
          <div class="inline-flex items-center gap-3 px-8 py-4 rounded-full bg-gradient-to-r from-[#F05D23]/20 to-[#d63c6b]/20 border border-[#F05D23]/30 backdrop-blur-md">
            <span class="w-2 h-2 bg-[#F05D23] rounded-full animate-pulse"></span>
            <span class="text-xl font-medium text-white">{t.comingSoon}</span>
          </div>
          <p class="text-sm text-[#6b7280]">
            {t.comingSoonSecondary}
          </p>
        </div>
      )}
    </div>

    <!-- App Showcase Visualization -->
    <div class="relative max-w-6xl mx-auto mt-12 mb-20">
      <!-- Central Phone Image -->
      <div class="relative z-20 mx-auto w-full max-w-[280px] lg:max-w-[400px]">
        <div class="relative overflow-hidden" style="mask-image: radial-gradient(ellipse at center, black 60%, transparent 100%); -webkit-mask-image: radial-gradient(ellipse at center, black 60%, transparent 100%);">
          <img 
            src="/assets/marketing/Hand_app.min.jpeg" 
            alt="Endure App Interface" 
            title="Endure App Dashboard"
            class="w-full h-auto"
          />
        </div>
      </div>

      <!-- Connecting SVG Lines (Desktop) -->
      <svg class="absolute inset-0 w-full h-full pointer-events-none hidden lg:block z-0" style="stroke-dasharray: 10; stroke-dashoffset: 10;">
          <defs>
              <linearGradient id="line-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stop-color="rgba(240, 93, 35, 0.1)" />
                  <stop offset="50%" stop-color="rgba(214, 60, 107, 0.4)" />
                  <stop offset="100%" stop-color="rgba(240, 93, 35, 0.1)" />
              </linearGradient>
          </defs>
          <!-- Top Left -->
          <path d="M22% 25% Q 35% 25%, 38% 35%" fill="none" stroke="url(#line-gradient)" stroke-width="2" />
          <!-- Top Right -->
          <path d="M78% 25% Q 65% 25%, 62% 35%" fill="none" stroke="url(#line-gradient)" stroke-width="2" />
           <!-- Bottom Left -->
           <path d="M22% 65% Q 35% 65%, 38% 55%" fill="none" stroke="url(#line-gradient)" stroke-width="2" />
           <!-- Bottom Right -->
           <path d="M78% 65% Q 65% 65%, 62% 55%" fill="none" stroke="url(#line-gradient)" stroke-width="2" />
      </svg>

      <!-- Mobile Connected Layout -->
      <div class="relative lg:hidden mt-8">
        <!-- Vertical Line -->
        <div class="absolute left-6 top-0 bottom-0 w-0.5 bg-gradient-to-b from-[#F05D23]/50 to-[#d63c6b]/10 md:left-1/2 md:-ml-px"></div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 relative">
           <!-- Refactored Feature Nodes for Mobile List -->
          {/* VO2Max Estimate */}
          <div class="relative pl-16 md:pl-0 md:pr-12 md:text-right">
             <!-- Dot -->
             <div class="absolute left-[21px] top-6 w-3 h-3 bg-[#F05D23] rounded-full shadow-lg shadow-[#F05D23]/50 md:left-auto md:right-[-42px] md:top-6 z-10"></div>
             
             <div class="bg-[#1a1d26]/80 backdrop-blur-sm border border-white/5 rounded-2xl p-6 hover:bg-[#1a1d26] transition-colors">
                <h3 class="text-lg font-bold text-white mb-2 flex items-center gap-3 md:justify-end">
                  <span class="md:hidden text-[#F05D23]">{ts.vo2max.title}</span>
                  <span class="hidden md:inline">{ts.vo2max.title}</span>
                </h3>
                <p class="text-[#a0a5b5] text-sm leading-relaxed">{ts.vo2max.description}</p>
            </div>
          </div>

          {/* Cross Platform */}
          <div class="relative pl-16 md:pl-12 md:mt-24">
             <!-- Dot -->
             <div class="absolute left-[21px] top-6 w-3 h-3 bg-[#d63c6b] rounded-full shadow-lg shadow-[#d63c6b]/50 md:left-[-42px] md:top-6 z-10"></div>
             
             <div class="bg-[#1a1d26]/80 backdrop-blur-sm border border-white/5 rounded-2xl p-6 hover:bg-[#1a1d26] transition-colors">
                <h3 class="text-lg font-bold text-white mb-2 flex items-center gap-3">
                   <span class="text-[#d63c6b]">{ts.crossPlatform.title}</span>
                </h3>
                <p class="text-[#a0a5b5] text-sm leading-relaxed">{ts.crossPlatform.description}</p>
            </div>
          </div>

          {/* Smart Trainer Control */}
           <div class="relative pl-16 md:pl-0 md:pr-12 md:text-right">
             <!-- Dot -->
             <div class="absolute left-[21px] top-6 w-3 h-3 bg-[#F05D23] rounded-full shadow-lg shadow-[#F05D23]/50 md:left-auto md:right-[-42px] md:top-6 z-10"></div>
             
             <div class="bg-[#1a1d26]/80 backdrop-blur-sm border border-white/5 rounded-2xl p-6 hover:bg-[#1a1d26] transition-colors">
                 <h3 class="text-lg font-bold text-white mb-2 flex items-center gap-3 md:justify-end">
                   <span class="md:hidden text-[#F05D23]">{ts.smartTrainer.title}</span>
                   <span class="hidden md:inline">{ts.smartTrainer.title}</span>
                 </h3>
                <p class="text-[#a0a5b5] text-sm leading-relaxed">{ts.smartTrainer.description}</p>
            </div>
          </div>

          {/* FTP Trend */}
           <div class="relative pl-16 md:pl-12 md:mt-24">
             <!-- Dot -->
             <div class="absolute left-[21px] top-6 w-3 h-3 bg-[#d63c6b] rounded-full shadow-lg shadow-[#d63c6b]/50 md:left-[-42px] md:top-6 z-10"></div>

             <div class="bg-[#1a1d26]/80 backdrop-blur-sm border border-white/5 rounded-2xl p-6 hover:bg-[#1a1d26] transition-colors">
                 <h3 class="text-lg font-bold text-white mb-2 flex items-center gap-3">
                   <span class="text-[#d63c6b]">{ts.ftpTrend.title}</span>
                 </h3>
                <p class="text-[#a0a5b5] text-sm leading-relaxed">{ts.ftpTrend.description}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Feature Nodes -->
      <div class="hidden lg:block">
        {/* VO2Max Estimate (Top Left) */}
        <div class="group relative p-6 lg:p-0 my-4 lg:my-0 flex flex-col lg:max-w-xs lg:absolute lg:top-[12%] lg:left-[-4%] lg:text-right">
             <div class="lg:hidden absolute inset-0 bg-[#1a1d26] border border-white/5 rounded-xl -z-10"></div>
             <div class="flex flex-col lg:items-end relative z-10"> 
                <div class="w-12 h-12 mb-4 rounded-xl bg-gradient-to-br from-[#F05D23] to-[#d63c6b] flex items-center justify-center text-white shadow-lg shadow-[#F05D23]/20">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>
                </div>
                <h3 class="text-xl font-bold text-white mb-2">{ts.vo2max.title}</h3>
                <p class="text-[#a0a5b5] leading-relaxed">{ts.vo2max.description}</p>
            </div>
        </div>

        {/* Cross Platform (Top Right) */}
        <div class="group relative p-6 lg:p-0 my-4 lg:my-0 flex flex-col lg:max-w-xs lg:absolute lg:top-[12%] lg:right-[-4%] lg:text-left">
             <div class="lg:hidden absolute inset-0 bg-[#1a1d26] border border-white/5 rounded-xl -z-10"></div>
             <div class="flex flex-col lg:items-start relative z-10"> 
                <div class="w-12 h-12 mb-4 rounded-xl bg-gradient-to-br from-[#F05D23] to-[#d63c6b] flex items-center justify-center text-white shadow-lg shadow-[#F05D23]/20">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
                </div>
                <h3 class="text-xl font-bold text-white mb-2">{ts.crossPlatform.title}</h3>
                <p class="text-[#a0a5b5] leading-relaxed">{ts.crossPlatform.description}</p>
            </div>
        </div>

        {/* Smart Trainer Control (Bottom Left) */}
        <div class="group relative p-6 lg:p-0 my-4 lg:my-0 flex flex-col lg:max-w-xs lg:absolute lg:bottom-[20%] lg:left-[-4%] lg:text-right">
             <div class="lg:hidden absolute inset-0 bg-[#1a1d26] border border-white/5 rounded-xl -z-10"></div>
             <div class="flex flex-col lg:items-end relative z-10"> 
                <div class="w-12 h-12 mb-4 rounded-xl bg-gradient-to-br from-[#F05D23] to-[#d63c6b] flex items-center justify-center text-white shadow-lg shadow-[#F05D23]/20">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10" /></svg>
                </div>
                <h3 class="text-xl font-bold text-white mb-2">{ts.smartTrainer.title}</h3>
                <p class="text-[#a0a5b5] leading-relaxed">{ts.smartTrainer.description}</p>
            </div>
        </div>

        {/* FTP Trend (Bottom Right) */}
        <div class="group relative p-6 lg:p-0 my-4 lg:my-0 flex flex-col lg:max-w-xs lg:absolute lg:bottom-[20%] lg:right-[-4%] lg:text-left">
             <div class="lg:hidden absolute inset-0 bg-[#1a1d26] border border-white/5 rounded-xl -z-10"></div>
             <div class="flex flex-col lg:items-start relative z-10"> 
                <div class="w-12 h-12 mb-4 rounded-xl bg-gradient-to-br from-[#F05D23] to-[#d63c6b] flex items-center justify-center text-white shadow-lg shadow-[#F05D23]/20">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg>
                </div>
                <h3 class="text-xl font-bold text-white mb-2">{ts.ftpTrend.title}</h3>
                <p class="text-[#a0a5b5] leading-relaxed">{ts.ftpTrend.description}</p>
            </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .gradient-text {
    @apply bg-clip-text text-transparent bg-gradient-to-r from-[#F05D23] to-[#d63c6b];
  }
</style>

<script>
  // Track download clicks
  const downloadBtn = document.getElementById('download-btn');
  
  if (downloadBtn) {
    downloadBtn.addEventListener('click', () => {
      // @ts-ignore
      if (typeof gtag !== 'undefined') {
        // @ts-ignore
        gtag('event', 'download_click', {
          'event_category': 'engagement',
          'event_label': 'windows_installer',
          'value': 1
        });
        console.log('Download event tracked');
      }
    });
  }
</script>
